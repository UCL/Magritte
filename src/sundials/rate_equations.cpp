// Magritte: Multidimensional Accelerated General-purpose Radiative Transfer
//
// Developed by: Frederik De Ceuster - University College London & KU Leuven
// _________________________________________________________________________


// User-defined vector and matrix accessor macros: Ith, IJth

#define Ith(v,i)    NV_Ith_S(v,i)         // Ith numbers components 0..NEQ-1
#define IJth(A,i,j) SM_ELEMENT_D(A,i,j)   // IJth numbers rows,cols 0..NEQ-1


// f: Computes function f(t,y) in dy = f(t,y)
// ------------------------------------------

static int f (realtype t, N_Vector y, N_Vector ydot, void *user_data)
{

  USER_DATA data = (USER_DATA) user_data;

  long gridp = data->gp;

  CELL *cell = data->cellpointer;

  realtype n_H = (realtype) cell[gridp].density;
  realtype x_e = 0.0;

  realtype loss, form;
  x_e = Ith(y,0)+Ith(y,1)+Ith(y,3)+Ith(y,4)+Ith(y,6)+Ith(y,7)+Ith(y,8)+Ith(y,9)+Ith(y,10)+Ith(y,12)+Ith(y,13)+Ith(y,14)+Ith(y,15)+Ith(y,18)+Ith(y,19)+Ith(y,22)+Ith(y,23)+Ith(y,26);
  data->electron_abundance = x_e;


  /* The ODEs created by MakeRates begin here... */

  loss = -cell[gridp].rate[67]*Ith(y,24)*n_H-cell[gridp].rate[68]*Ith(y,20)*n_H-cell[gridp].rate[69]*Ith(y,16)*n_H-cell[gridp].rate[70]*Ith(y,21)*n_H-cell[gridp].rate[71]*Ith(y,29)*n_H-cell[gridp].rate[72]*Ith(y,11)*n_H-cell[gridp].rate[73]*Ith(y,28)*n_H-cell[gridp].rate[74]*Ith(y,17)*n_H-cell[gridp].rate[75]*Ith(y,2)*n_H-cell[gridp].rate[76]*Ith(y,27)*n_H-cell[gridp].rate[216]*x_e*n_H-cell[gridp].rate[217]*x_e*n_H-cell[gridp].rate[266]-cell[gridp].rate[267];
  form = +cell[gridp].rate[48]*Ith(y,3)*Ith(y,30)*n_H;
  Ith(ydot,0) = form+Ith(y,0)*loss;

  loss = -cell[gridp].rate[49]*Ith(y,30)*n_H-cell[gridp].rate[77]*Ith(y,20)*n_H-cell[gridp].rate[78]*Ith(y,16)*n_H-cell[gridp].rate[79]*Ith(y,16)*n_H-cell[gridp].rate[80]*Ith(y,21)*n_H-cell[gridp].rate[81]*Ith(y,11)*n_H-cell[gridp].rate[82]*Ith(y,11)*n_H-cell[gridp].rate[83]*Ith(y,11)*n_H-cell[gridp].rate[84]*Ith(y,11)*n_H-cell[gridp].rate[85]*Ith(y,28)*n_H-cell[gridp].rate[86]*Ith(y,17)*n_H-cell[gridp].rate[87]*Ith(y,17)*n_H-cell[gridp].rate[88]*Ith(y,27)*n_H-cell[gridp].rate[89]*Ith(y,27)*n_H-cell[gridp].rate[90]*Ith(y,27)*n_H-cell[gridp].rate[91]*Ith(y,5)*n_H-cell[gridp].rate[155]*Ith(y,31)*n_H-cell[gridp].rate[156]*Ith(y,31)*n_H-cell[gridp].rate[169]*Ith(y,30)*n_H-cell[gridp].rate[177]*Ith(y,24)*n_H-cell[gridp].rate[178]*Ith(y,20)*n_H-cell[gridp].rate[179]*Ith(y,11)*n_H-cell[gridp].rate[180]*Ith(y,17)*n_H-cell[gridp].rate[181]*Ith(y,5)*n_H-cell[gridp].rate[242]*x_e*n_H;
  form = +cell[gridp].rate[296]*Ith(y,25);
  Ith(ydot,1) = form+Ith(y,1)*loss;

  loss = -cell[gridp].rate[75]*Ith(y,0)*n_H-cell[gridp].rate[147]*Ith(y,4)*n_H-cell[gridp].rate[166]*Ith(y,18)*n_H-cell[gridp].rate[184]*Ith(y,10)*n_H-cell[gridp].rate[190]*Ith(y,26)*n_H-cell[gridp].rate[198]*Ith(y,19)*n_H-cell[gridp].rate[210]*Ith(y,12)*n_H-cell[gridp].rate[213]*Ith(y,15)*n_H-cell[gridp].rate[288]-cell[gridp].rate[311];
  form = +cell[gridp].rate[248]*Ith(y,9)*x_e*n_H;
  Ith(ydot,2) = form+Ith(y,2)*loss;

  loss = -cell[gridp].rate[48]*Ith(y,30)*n_H-cell[gridp].rate[50]*Ith(y,24)*n_H-cell[gridp].rate[52]*Ith(y,20)*n_H-cell[gridp].rate[54]*Ith(y,16)*n_H-cell[gridp].rate[56]*Ith(y,29)*n_H-cell[gridp].rate[58]*Ith(y,11)*n_H-cell[gridp].rate[60]*Ith(y,11)*n_H-cell[gridp].rate[61]*Ith(y,28)*n_H-cell[gridp].rate[63]*Ith(y,17)*n_H-cell[gridp].rate[65]*Ith(y,27)*n_H-cell[gridp].rate[154]*Ith(y,31)*n_H-cell[gridp].rate[170]*Ith(y,20)*n_H-cell[gridp].rate[171]*Ith(y,16)*n_H-cell[gridp].rate[172]*Ith(y,11)*n_H-cell[gridp].rate[173]*Ith(y,28)*n_H-cell[gridp].rate[174]*Ith(y,17)*n_H-cell[gridp].rate[175]*Ith(y,27)*n_H-cell[gridp].rate[176]*Ith(y,5)*n_H-cell[gridp].rate[215]*x_e*n_H-cell[gridp].rate[265];
  form = +cell[gridp].rate[153]*Ith(y,18)*Ith(y,30)*n_H+cell[gridp].rate[169]*Ith(y,1)*Ith(y,30)*n_H+cell[gridp].rate[249]*Ith(y,18)*Ith(y,31)*n_H+cell[gridp].rate[250]*Ith(y,18)*Ith(y,31)*n_H+cell[gridp].rate[266]*Ith(y,0)+cell[gridp].rate[295]*Ith(y,30);
  Ith(ydot,3) = form+Ith(y,3)*loss;

  loss = -cell[gridp].rate[47]*Ith(y,31)*n_H-cell[gridp].rate[95]*Ith(y,24)*n_H-cell[gridp].rate[107]*Ith(y,20)*n_H-cell[gridp].rate[119]*Ith(y,16)*n_H-cell[gridp].rate[130]*Ith(y,29)*n_H-cell[gridp].rate[140]*Ith(y,28)*n_H-cell[gridp].rate[146]*Ith(y,17)*n_H-cell[gridp].rate[147]*Ith(y,2)*n_H-cell[gridp].rate[148]*Ith(y,27)*n_H-cell[gridp].rate[229]*x_e*n_H-cell[gridp].rate[230]*x_e*n_H;
  form = +cell[gridp].rate[58]*Ith(y,3)*Ith(y,11)*n_H+cell[gridp].rate[59]*Ith(y,6)*Ith(y,30)*n_H+cell[gridp].rate[72]*Ith(y,0)*Ith(y,11)*n_H+cell[gridp].rate[132]*Ith(y,6)*Ith(y,11)*n_H+cell[gridp].rate[133]*Ith(y,8)*Ith(y,11)*n_H+cell[gridp].rate[258]*Ith(y,19)*Ith(y,30)*n_H;
  Ith(ydot,4) = form+Ith(y,4)*loss;

  loss = -cell[gridp].rate[7]*Ith(y,31)*n_H-cell[gridp].rate[14]*Ith(y,30)*n_H-cell[gridp].rate[18]*Ith(y,24)*n_H-cell[gridp].rate[23]*Ith(y,20)*n_H-cell[gridp].rate[31]*Ith(y,16)*n_H-cell[gridp].rate[91]*Ith(y,1)*n_H-cell[gridp].rate[100]*Ith(y,10)*n_H-cell[gridp].rate[101]*Ith(y,10)*n_H-cell[gridp].rate[114]*Ith(y,26)*n_H-cell[gridp].rate[115]*Ith(y,26)*n_H-cell[gridp].rate[124]*Ith(y,23)*n_H-cell[gridp].rate[168]*Ith(y,18)*n_H-cell[gridp].rate[176]*Ith(y,3)*n_H-cell[gridp].rate[181]*Ith(y,1)*n_H-cell[gridp].rate[204]*Ith(y,7)*n_H-cell[gridp].rate[206]*Ith(y,6)*n_H-cell[gridp].rate[209]*Ith(y,8)*n_H-cell[gridp].rate[212]*Ith(y,12)*n_H-cell[gridp].rate[214]*Ith(y,14)*n_H-cell[gridp].rate[290]-cell[gridp].rate[291]-cell[gridp].rate[313]-cell[gridp].rate[314]-cell[gridp].rate[319]*Ith(y,31)*n_H-cell[gridp].rate[325]*Ith(y,30)*n_H;
  form = +cell[gridp].rate[37]*Ith(y,28)*Ith(y,29)*n_H+cell[gridp].rate[186]*Ith(y,15)*Ith(y,24)*n_H+cell[gridp].rate[192]*Ith(y,15)*Ith(y,20)*n_H+cell[gridp].rate[197]*Ith(y,15)*Ith(y,16)*n_H+cell[gridp].rate[213]*Ith(y,2)*Ith(y,15)*n_H+cell[gridp].rate[264]*Ith(y,29)*Ith(y,29)*n_H;
  Ith(ydot,5) = form+Ith(y,5)*loss;

  loss = -cell[gridp].rate[46]*Ith(y,31)*n_H-cell[gridp].rate[59]*Ith(y,30)*n_H-cell[gridp].rate[127]*Ith(y,29)*n_H-cell[gridp].rate[132]*Ith(y,11)*n_H-cell[gridp].rate[135]*Ith(y,17)*n_H-cell[gridp].rate[137]*Ith(y,27)*n_H-cell[gridp].rate[206]*Ith(y,5)*n_H-cell[gridp].rate[226]*x_e*n_H-cell[gridp].rate[227]*x_e*n_H;
  form = +cell[gridp].rate[47]*Ith(y,4)*Ith(y,31)*n_H+cell[gridp].rate[70]*Ith(y,0)*Ith(y,21)*n_H+cell[gridp].rate[163]*Ith(y,11)*Ith(y,18)*n_H+cell[gridp].rate[172]*Ith(y,3)*Ith(y,11)*n_H+cell[gridp].rate[179]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[199]*Ith(y,7)*Ith(y,11)*n_H+cell[gridp].rate[205]*Ith(y,11)*Ith(y,14)*n_H;
  Ith(ydot,6) = form+Ith(y,6)*loss;

  loss = -cell[gridp].rate[57]*Ith(y,30)*n_H-cell[gridp].rate[104]*Ith(y,20)*n_H-cell[gridp].rate[126]*Ith(y,11)*n_H-cell[gridp].rate[128]*Ith(y,28)*n_H-cell[gridp].rate[160]*Ith(y,31)*n_H-cell[gridp].rate[187]*Ith(y,20)*n_H-cell[gridp].rate[193]*Ith(y,16)*n_H-cell[gridp].rate[199]*Ith(y,11)*n_H-cell[gridp].rate[200]*Ith(y,28)*n_H-cell[gridp].rate[201]*Ith(y,17)*n_H-cell[gridp].rate[203]*Ith(y,27)*n_H-cell[gridp].rate[204]*Ith(y,5)*n_H-cell[gridp].rate[247]*x_e*n_H-cell[gridp].rate[259]*Ith(y,24)*n_H;
  form = +cell[gridp].rate[85]*Ith(y,1)*Ith(y,28)*n_H+cell[gridp].rate[90]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[91]*Ith(y,1)*Ith(y,5)*n_H+cell[gridp].rate[101]*Ith(y,5)*Ith(y,10)*n_H+cell[gridp].rate[161]*Ith(y,18)*Ith(y,29)*n_H+cell[gridp].rate[162]*Ith(y,18)*Ith(y,29)*n_H+cell[gridp].rate[202]*Ith(y,14)*Ith(y,29)*n_H+cell[gridp].rate[298]*Ith(y,29);
  Ith(ydot,7) = form+Ith(y,7)*loss;

  loss = -cell[gridp].rate[62]*Ith(y,30)*n_H-cell[gridp].rate[92]*Ith(y,24)*n_H-cell[gridp].rate[105]*Ith(y,20)*n_H-cell[gridp].rate[118]*Ith(y,16)*n_H-cell[gridp].rate[129]*Ith(y,29)*n_H-cell[gridp].rate[133]*Ith(y,11)*n_H-cell[gridp].rate[134]*Ith(y,11)*n_H-cell[gridp].rate[139]*Ith(y,28)*n_H-cell[gridp].rate[141]*Ith(y,17)*n_H-cell[gridp].rate[143]*Ith(y,27)*n_H-cell[gridp].rate[188]*Ith(y,20)*n_H-cell[gridp].rate[194]*Ith(y,16)*n_H-cell[gridp].rate[207]*Ith(y,17)*n_H-cell[gridp].rate[209]*Ith(y,5)*n_H-cell[gridp].rate[228]*x_e*n_H-cell[gridp].rate[285];
  form = +cell[gridp].rate[56]*Ith(y,3)*Ith(y,29)*n_H+cell[gridp].rate[57]*Ith(y,7)*Ith(y,30)*n_H+cell[gridp].rate[71]*Ith(y,0)*Ith(y,29)*n_H+cell[gridp].rate[87]*Ith(y,1)*Ith(y,17)*n_H+cell[gridp].rate[164]*Ith(y,18)*Ith(y,28)*n_H+cell[gridp].rate[173]*Ith(y,3)*Ith(y,28)*n_H+cell[gridp].rate[200]*Ith(y,7)*Ith(y,28)*n_H+cell[gridp].rate[208]*Ith(y,14)*Ith(y,28)*n_H+cell[gridp].rate[283]*Ith(y,28);
  Ith(ydot,8) = form+Ith(y,8)*loss;

  loss = -cell[gridp].rate[248]*x_e*n_H;
  form = +cell[gridp].rate[75]*Ith(y,0)*Ith(y,2)*n_H+cell[gridp].rate[147]*Ith(y,2)*Ith(y,4)*n_H+cell[gridp].rate[166]*Ith(y,2)*Ith(y,18)*n_H+cell[gridp].rate[184]*Ith(y,2)*Ith(y,10)*n_H+cell[gridp].rate[190]*Ith(y,2)*Ith(y,26)*n_H+cell[gridp].rate[198]*Ith(y,2)*Ith(y,19)*n_H+cell[gridp].rate[210]*Ith(y,2)*Ith(y,12)*n_H+cell[gridp].rate[213]*Ith(y,2)*Ith(y,15)*n_H+cell[gridp].rate[288]*Ith(y,2)+cell[gridp].rate[311]*Ith(y,2);
  Ith(ydot,9) = form+Ith(y,9)*loss;

  loss = -cell[gridp].rate[51]*Ith(y,30)*n_H-cell[gridp].rate[93]*Ith(y,28)*n_H-cell[gridp].rate[94]*Ith(y,28)*n_H-cell[gridp].rate[97]*Ith(y,17)*n_H-cell[gridp].rate[100]*Ith(y,5)*n_H-cell[gridp].rate[101]*Ith(y,5)*n_H-cell[gridp].rate[182]*Ith(y,20)*n_H-cell[gridp].rate[183]*Ith(y,16)*n_H-cell[gridp].rate[184]*Ith(y,2)*n_H-cell[gridp].rate[243]*x_e*n_H-cell[gridp].rate[244]*x_e*n_H-cell[gridp].rate[245]*x_e*n_H-cell[gridp].rate[252]*Ith(y,31)*n_H-cell[gridp].rate[256]*Ith(y,30)*n_H-cell[gridp].rate[262]*Ith(y,29)*n_H-cell[gridp].rate[263]*Ith(y,29)*n_H;
  form = +cell[gridp].rate[41]*Ith(y,26)*Ith(y,31)*n_H+cell[gridp].rate[77]*Ith(y,1)*Ith(y,20)*n_H+cell[gridp].rate[78]*Ith(y,1)*Ith(y,16)*n_H+cell[gridp].rate[88]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[89]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[177]*Ith(y,1)*Ith(y,24)*n_H+cell[gridp].rate[185]*Ith(y,14)*Ith(y,24)*n_H+cell[gridp].rate[186]*Ith(y,15)*Ith(y,24)*n_H+cell[gridp].rate[268]*Ith(y,24)+cell[gridp].rate[297]*Ith(y,24)+cell[gridp].rate[300]*Ith(y,24)+cell[gridp].rate[302]*Ith(y,26);
  Ith(ydot,10) = form+Ith(y,10)*loss;

  loss = -cell[gridp].rate[3]*Ith(y,31)*n_H-cell[gridp].rate[22]*Ith(y,20)*n_H-cell[gridp].rate[28]*Ith(y,16)*n_H-cell[gridp].rate[36]*Ith(y,29)*n_H-cell[gridp].rate[39]*Ith(y,28)*n_H-cell[gridp].rate[45]*Ith(y,18)*n_H-cell[gridp].rate[58]*Ith(y,3)*n_H-cell[gridp].rate[60]*Ith(y,3)*n_H-cell[gridp].rate[72]*Ith(y,0)*n_H-cell[gridp].rate[81]*Ith(y,1)*n_H-cell[gridp].rate[82]*Ith(y,1)*n_H-cell[gridp].rate[83]*Ith(y,1)*n_H-cell[gridp].rate[84]*Ith(y,1)*n_H-cell[gridp].rate[126]*Ith(y,7)*n_H-cell[gridp].rate[132]*Ith(y,6)*n_H-cell[gridp].rate[133]*Ith(y,8)*n_H-cell[gridp].rate[134]*Ith(y,8)*n_H-cell[gridp].rate[136]*Ith(y,12)*n_H-cell[gridp].rate[138]*Ith(y,14)*n_H-cell[gridp].rate[163]*Ith(y,18)*n_H-cell[gridp].rate[172]*Ith(y,3)*n_H-cell[gridp].rate[179]*Ith(y,1)*n_H-cell[gridp].rate[199]*Ith(y,7)*n_H-cell[gridp].rate[205]*Ith(y,14)*n_H-cell[gridp].rate[280]-cell[gridp].rate[281]-cell[gridp].rate[282]-cell[gridp].rate[308];
  form = +cell[gridp].rate[11]*Ith(y,21)*Ith(y,30)*n_H+cell[gridp].rate[32]*Ith(y,21)*Ith(y,21)*n_H+cell[gridp].rate[33]*Ith(y,21)*Ith(y,28)*n_H+cell[gridp].rate[35]*Ith(y,17)*Ith(y,21)*n_H+cell[gridp].rate[95]*Ith(y,4)*Ith(y,24)*n_H+cell[gridp].rate[107]*Ith(y,4)*Ith(y,20)*n_H+cell[gridp].rate[119]*Ith(y,4)*Ith(y,16)*n_H+cell[gridp].rate[140]*Ith(y,4)*Ith(y,28)*n_H+cell[gridp].rate[146]*Ith(y,4)*Ith(y,17)*n_H+cell[gridp].rate[147]*Ith(y,2)*Ith(y,4)*n_H+cell[gridp].rate[148]*Ith(y,4)*Ith(y,27)*n_H+cell[gridp].rate[206]*Ith(y,5)*Ith(y,6)*n_H+cell[gridp].rate[230]*Ith(y,4)*x_e*n_H;
  Ith(ydot,11) = form+Ith(y,11)*loss;

  loss = -cell[gridp].rate[64]*Ith(y,30)*n_H-cell[gridp].rate[96]*Ith(y,24)*n_H-cell[gridp].rate[109]*Ith(y,20)*n_H-cell[gridp].rate[120]*Ith(y,16)*n_H-cell[gridp].rate[131]*Ith(y,29)*n_H-cell[gridp].rate[136]*Ith(y,11)*n_H-cell[gridp].rate[142]*Ith(y,28)*n_H-cell[gridp].rate[149]*Ith(y,17)*n_H-cell[gridp].rate[150]*Ith(y,27)*n_H-cell[gridp].rate[189]*Ith(y,20)*n_H-cell[gridp].rate[195]*Ith(y,16)*n_H-cell[gridp].rate[210]*Ith(y,2)*n_H-cell[gridp].rate[212]*Ith(y,5)*n_H-cell[gridp].rate[231]*x_e*n_H-cell[gridp].rate[232]*x_e*n_H-cell[gridp].rate[233]*x_e*n_H;
  form = +cell[gridp].rate[61]*Ith(y,3)*Ith(y,28)*n_H+cell[gridp].rate[62]*Ith(y,8)*Ith(y,30)*n_H+cell[gridp].rate[73]*Ith(y,0)*Ith(y,28)*n_H+cell[gridp].rate[139]*Ith(y,8)*Ith(y,28)*n_H+cell[gridp].rate[140]*Ith(y,4)*Ith(y,28)*n_H+cell[gridp].rate[145]*Ith(y,22)*Ith(y,28)*n_H+cell[gridp].rate[165]*Ith(y,17)*Ith(y,18)*n_H+cell[gridp].rate[174]*Ith(y,3)*Ith(y,17)*n_H+cell[gridp].rate[180]*Ith(y,1)*Ith(y,17)*n_H+cell[gridp].rate[201]*Ith(y,7)*Ith(y,17)*n_H+cell[gridp].rate[207]*Ith(y,8)*Ith(y,17)*n_H+cell[gridp].rate[211]*Ith(y,14)*Ith(y,17)*n_H+cell[gridp].rate[287]*Ith(y,17);
  Ith(ydot,12) = form+Ith(y,12)*loss;

  loss = -cell[gridp].rate[98]*Ith(y,24)*n_H-cell[gridp].rate[111]*Ith(y,20)*n_H-cell[gridp].rate[121]*Ith(y,16)*n_H-cell[gridp].rate[234]*x_e*n_H-cell[gridp].rate[235]*x_e*n_H-cell[gridp].rate[236]*x_e*n_H-cell[gridp].rate[237]*x_e*n_H;
  form = +cell[gridp].rate[63]*Ith(y,3)*Ith(y,17)*n_H+cell[gridp].rate[64]*Ith(y,12)*Ith(y,30)*n_H+cell[gridp].rate[74]*Ith(y,0)*Ith(y,17)*n_H+cell[gridp].rate[108]*Ith(y,17)*Ith(y,26)*n_H+cell[gridp].rate[130]*Ith(y,4)*Ith(y,29)*n_H+cell[gridp].rate[134]*Ith(y,8)*Ith(y,11)*n_H+cell[gridp].rate[135]*Ith(y,6)*Ith(y,17)*n_H+cell[gridp].rate[136]*Ith(y,11)*Ith(y,12)*n_H+cell[gridp].rate[141]*Ith(y,8)*Ith(y,17)*n_H+cell[gridp].rate[142]*Ith(y,12)*Ith(y,28)*n_H+cell[gridp].rate[146]*Ith(y,4)*Ith(y,17)*n_H+cell[gridp].rate[149]*Ith(y,12)*Ith(y,17)*n_H+cell[gridp].rate[152]*Ith(y,17)*Ith(y,22)*n_H;
  Ith(ydot,13) = form+Ith(y,13)*loss;

  loss = -cell[gridp].rate[66]*Ith(y,30)*n_H-cell[gridp].rate[112]*Ith(y,20)*n_H-cell[gridp].rate[122]*Ith(y,16)*n_H-cell[gridp].rate[138]*Ith(y,11)*n_H-cell[gridp].rate[144]*Ith(y,28)*n_H-cell[gridp].rate[151]*Ith(y,17)*n_H-cell[gridp].rate[167]*Ith(y,31)*n_H-cell[gridp].rate[185]*Ith(y,24)*n_H-cell[gridp].rate[191]*Ith(y,20)*n_H-cell[gridp].rate[196]*Ith(y,16)*n_H-cell[gridp].rate[202]*Ith(y,29)*n_H-cell[gridp].rate[205]*Ith(y,11)*n_H-cell[gridp].rate[208]*Ith(y,28)*n_H-cell[gridp].rate[211]*Ith(y,17)*n_H-cell[gridp].rate[214]*Ith(y,5)*n_H-cell[gridp].rate[238]*x_e*n_H;
  form = +cell[gridp].rate[93]*Ith(y,10)*Ith(y,28)*n_H+cell[gridp].rate[100]*Ith(y,5)*Ith(y,10)*n_H+cell[gridp].rate[102]*Ith(y,15)*Ith(y,24)*n_H+cell[gridp].rate[103]*Ith(y,26)*Ith(y,29)*n_H+cell[gridp].rate[104]*Ith(y,7)*Ith(y,20)*n_H+cell[gridp].rate[106]*Ith(y,26)*Ith(y,28)*n_H+cell[gridp].rate[114]*Ith(y,5)*Ith(y,26)*n_H+cell[gridp].rate[175]*Ith(y,3)*Ith(y,27)*n_H+cell[gridp].rate[203]*Ith(y,7)*Ith(y,27)*n_H+cell[gridp].rate[259]*Ith(y,7)*Ith(y,24)*n_H+cell[gridp].rate[262]*Ith(y,10)*Ith(y,29)*n_H+cell[gridp].rate[263]*Ith(y,10)*Ith(y,29)*n_H+cell[gridp].rate[299]*Ith(y,27);
  Ith(ydot,14) = form+Ith(y,14)*loss;

  loss = -cell[gridp].rate[102]*Ith(y,24)*n_H-cell[gridp].rate[116]*Ith(y,20)*n_H-cell[gridp].rate[186]*Ith(y,24)*n_H-cell[gridp].rate[192]*Ith(y,20)*n_H-cell[gridp].rate[197]*Ith(y,16)*n_H-cell[gridp].rate[213]*Ith(y,2)*n_H-cell[gridp].rate[240]*x_e*n_H;
  form = +cell[gridp].rate[128]*Ith(y,7)*Ith(y,28)*n_H+cell[gridp].rate[129]*Ith(y,8)*Ith(y,29)*n_H+cell[gridp].rate[131]*Ith(y,12)*Ith(y,29)*n_H+cell[gridp].rate[168]*Ith(y,5)*Ith(y,18)*n_H+cell[gridp].rate[176]*Ith(y,3)*Ith(y,5)*n_H+cell[gridp].rate[181]*Ith(y,1)*Ith(y,5)*n_H+cell[gridp].rate[204]*Ith(y,5)*Ith(y,7)*n_H+cell[gridp].rate[206]*Ith(y,5)*Ith(y,6)*n_H+cell[gridp].rate[209]*Ith(y,5)*Ith(y,8)*n_H+cell[gridp].rate[212]*Ith(y,5)*Ith(y,12)*n_H+cell[gridp].rate[214]*Ith(y,5)*Ith(y,14)*n_H+cell[gridp].rate[291]*Ith(y,5)+cell[gridp].rate[314]*Ith(y,5);
  Ith(ydot,15) = form+Ith(y,15)*loss;

  loss = -cell[gridp].rate[1]*Ith(y,31)*n_H-cell[gridp].rate[10]*Ith(y,30)*n_H-cell[gridp].rate[15]*Ith(y,24)*n_H-2*cell[gridp].rate[24]*Ith(y,16)*n_H-cell[gridp].rate[25]*Ith(y,29)*n_H-cell[gridp].rate[26]*Ith(y,29)*n_H-cell[gridp].rate[27]*Ith(y,29)*n_H-cell[gridp].rate[28]*Ith(y,11)*n_H-cell[gridp].rate[29]*Ith(y,28)*n_H-cell[gridp].rate[30]*Ith(y,28)*n_H-cell[gridp].rate[31]*Ith(y,5)*n_H-cell[gridp].rate[42]*Ith(y,18)*n_H-cell[gridp].rate[54]*Ith(y,3)*n_H-cell[gridp].rate[69]*Ith(y,0)*n_H-cell[gridp].rate[78]*Ith(y,1)*n_H-cell[gridp].rate[79]*Ith(y,1)*n_H-cell[gridp].rate[118]*Ith(y,8)*n_H-cell[gridp].rate[119]*Ith(y,4)*n_H-cell[gridp].rate[120]*Ith(y,12)*n_H-cell[gridp].rate[121]*Ith(y,13)*n_H-cell[gridp].rate[122]*Ith(y,14)*n_H-cell[gridp].rate[123]*Ith(y,22)*n_H-cell[gridp].rate[158]*Ith(y,18)*n_H-cell[gridp].rate[171]*Ith(y,3)*n_H-cell[gridp].rate[183]*Ith(y,10)*n_H-cell[gridp].rate[193]*Ith(y,7)*n_H-cell[gridp].rate[194]*Ith(y,8)*n_H-cell[gridp].rate[195]*Ith(y,12)*n_H-cell[gridp].rate[196]*Ith(y,14)*n_H-cell[gridp].rate[197]*Ith(y,15)*n_H-cell[gridp].rate[272]-cell[gridp].rate[273]-cell[gridp].rate[303]-cell[gridp].rate[304];
  form = +cell[gridp].rate[2]*Ith(y,21)*Ith(y,31)*n_H+cell[gridp].rate[9]*Ith(y,20)*Ith(y,30)*n_H+cell[gridp].rate[22]*Ith(y,11)*Ith(y,20)*n_H+cell[gridp].rate[32]*Ith(y,21)*Ith(y,21)*n_H+cell[gridp].rate[34]*Ith(y,21)*Ith(y,28)*n_H+cell[gridp].rate[130]*Ith(y,4)*Ith(y,29)*n_H+cell[gridp].rate[134]*Ith(y,8)*Ith(y,11)*n_H+cell[gridp].rate[222]*Ith(y,19)*x_e*n_H+cell[gridp].rate[227]*Ith(y,6)*x_e*n_H+cell[gridp].rate[255]*Ith(y,24)*Ith(y,30)*n_H+cell[gridp].rate[276]*Ith(y,21)+cell[gridp].rate[281]*Ith(y,11)+cell[gridp].rate[306]*Ith(y,21)+cell[gridp].rate[308]*Ith(y,11);
  Ith(ydot,16) = form+Ith(y,16)*loss;

  loss = -cell[gridp].rate[5]*Ith(y,31)*n_H-cell[gridp].rate[35]*Ith(y,21)*n_H-cell[gridp].rate[38]*Ith(y,29)*n_H-cell[gridp].rate[63]*Ith(y,3)*n_H-cell[gridp].rate[74]*Ith(y,0)*n_H-cell[gridp].rate[86]*Ith(y,1)*n_H-cell[gridp].rate[87]*Ith(y,1)*n_H-cell[gridp].rate[97]*Ith(y,10)*n_H-cell[gridp].rate[108]*Ith(y,26)*n_H-cell[gridp].rate[110]*Ith(y,26)*n_H-cell[gridp].rate[135]*Ith(y,6)*n_H-cell[gridp].rate[141]*Ith(y,8)*n_H-cell[gridp].rate[146]*Ith(y,4)*n_H-cell[gridp].rate[149]*Ith(y,12)*n_H-cell[gridp].rate[151]*Ith(y,14)*n_H-cell[gridp].rate[152]*Ith(y,22)*n_H-cell[gridp].rate[165]*Ith(y,18)*n_H-cell[gridp].rate[174]*Ith(y,3)*n_H-cell[gridp].rate[180]*Ith(y,1)*n_H-cell[gridp].rate[201]*Ith(y,7)*n_H-cell[gridp].rate[207]*Ith(y,8)*n_H-cell[gridp].rate[211]*Ith(y,14)*n_H-cell[gridp].rate[286]-cell[gridp].rate[287]-cell[gridp].rate[310]-cell[gridp].rate[318]*Ith(y,31)*n_H-cell[gridp].rate[324]*Ith(y,30)*n_H;
  form = +cell[gridp].rate[13]*Ith(y,28)*Ith(y,30)*n_H+cell[gridp].rate[30]*Ith(y,16)*Ith(y,28)*n_H+cell[gridp].rate[31]*Ith(y,5)*Ith(y,16)*n_H+cell[gridp].rate[34]*Ith(y,21)*Ith(y,28)*n_H+cell[gridp].rate[39]*Ith(y,11)*Ith(y,28)*n_H+cell[gridp].rate[40]*Ith(y,28)*Ith(y,28)*n_H+cell[gridp].rate[111]*Ith(y,13)*Ith(y,20)*n_H+cell[gridp].rate[121]*Ith(y,13)*Ith(y,16)*n_H+cell[gridp].rate[189]*Ith(y,12)*Ith(y,20)*n_H+cell[gridp].rate[195]*Ith(y,12)*Ith(y,16)*n_H+cell[gridp].rate[210]*Ith(y,2)*Ith(y,12)*n_H+cell[gridp].rate[212]*Ith(y,5)*Ith(y,12)*n_H+cell[gridp].rate[237]*Ith(y,13)*x_e*n_H+cell[gridp].rate[254]*Ith(y,28)*Ith(y,31)*n_H;
  Ith(ydot,17) = form+Ith(y,17)*loss;

  loss = -cell[gridp].rate[42]*Ith(y,16)*n_H-cell[gridp].rate[45]*Ith(y,11)*n_H-cell[gridp].rate[153]*Ith(y,30)*n_H-cell[gridp].rate[157]*Ith(y,20)*n_H-cell[gridp].rate[158]*Ith(y,16)*n_H-cell[gridp].rate[159]*Ith(y,21)*n_H-cell[gridp].rate[161]*Ith(y,29)*n_H-cell[gridp].rate[162]*Ith(y,29)*n_H-cell[gridp].rate[163]*Ith(y,11)*n_H-cell[gridp].rate[164]*Ith(y,28)*n_H-cell[gridp].rate[165]*Ith(y,17)*n_H-cell[gridp].rate[166]*Ith(y,2)*n_H-cell[gridp].rate[168]*Ith(y,5)*n_H-cell[gridp].rate[241]*x_e*n_H-cell[gridp].rate[249]*Ith(y,31)*n_H-cell[gridp].rate[250]*Ith(y,31)*n_H;
  form = +cell[gridp].rate[49]*Ith(y,1)*Ith(y,30)*n_H+cell[gridp].rate[83]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[86]*Ith(y,1)*Ith(y,17)*n_H+cell[gridp].rate[94]*Ith(y,10)*Ith(y,28)*n_H+cell[gridp].rate[154]*Ith(y,3)*Ith(y,31)*n_H+cell[gridp].rate[155]*Ith(y,1)*Ith(y,31)*n_H+cell[gridp].rate[156]*Ith(y,1)*Ith(y,31)*n_H+cell[gridp].rate[160]*Ith(y,7)*Ith(y,31)*n_H+cell[gridp].rate[167]*Ith(y,14)*Ith(y,31)*n_H+cell[gridp].rate[265]*Ith(y,3)+cell[gridp].rate[267]*Ith(y,0)+cell[gridp].rate[271]*Ith(y,26)+cell[gridp].rate[285]*Ith(y,8)+cell[gridp].rate[292]*Ith(y,31)+cell[gridp].rate[293]*Ith(y,30);
  Ith(ydot,18) = form+Ith(y,18)*loss;

  loss = -cell[gridp].rate[44]*Ith(y,31)*n_H-cell[gridp].rate[125]*Ith(y,29)*n_H-cell[gridp].rate[198]*Ith(y,2)*n_H-cell[gridp].rate[222]*x_e*n_H-cell[gridp].rate[223]*x_e*n_H-cell[gridp].rate[224]*x_e*n_H-cell[gridp].rate[225]*x_e*n_H-cell[gridp].rate[246]*x_e*n_H-cell[gridp].rate[258]*Ith(y,30)*n_H-cell[gridp].rate[277]-cell[gridp].rate[279];
  form = +cell[gridp].rate[45]*Ith(y,11)*Ith(y,18)*n_H+cell[gridp].rate[46]*Ith(y,6)*Ith(y,31)*n_H+cell[gridp].rate[54]*Ith(y,3)*Ith(y,16)*n_H+cell[gridp].rate[55]*Ith(y,23)*Ith(y,30)*n_H+cell[gridp].rate[60]*Ith(y,3)*Ith(y,11)*n_H+cell[gridp].rate[69]*Ith(y,0)*Ith(y,16)*n_H+cell[gridp].rate[84]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[118]*Ith(y,8)*Ith(y,16)*n_H+cell[gridp].rate[119]*Ith(y,4)*Ith(y,16)*n_H+cell[gridp].rate[120]*Ith(y,12)*Ith(y,16)*n_H+cell[gridp].rate[121]*Ith(y,13)*Ith(y,16)*n_H+cell[gridp].rate[123]*Ith(y,16)*Ith(y,22)*n_H+cell[gridp].rate[126]*Ith(y,7)*Ith(y,11)*n_H+cell[gridp].rate[127]*Ith(y,6)*Ith(y,29)*n_H+cell[gridp].rate[159]*Ith(y,18)*Ith(y,21)*n_H+cell[gridp].rate[275]*Ith(y,21)+cell[gridp].rate[305]*Ith(y,21);
  Ith(ydot,19) = form+Ith(y,19)*loss;

  loss = -cell[gridp].rate[0]*Ith(y,31)*n_H-cell[gridp].rate[9]*Ith(y,30)*n_H-cell[gridp].rate[19]*Ith(y,29)*n_H-cell[gridp].rate[20]*Ith(y,29)*n_H-cell[gridp].rate[21]*Ith(y,29)*n_H-cell[gridp].rate[22]*Ith(y,11)*n_H-cell[gridp].rate[23]*Ith(y,5)*n_H-cell[gridp].rate[52]*Ith(y,3)*n_H-cell[gridp].rate[68]*Ith(y,0)*n_H-cell[gridp].rate[77]*Ith(y,1)*n_H-cell[gridp].rate[104]*Ith(y,7)*n_H-cell[gridp].rate[105]*Ith(y,8)*n_H-cell[gridp].rate[107]*Ith(y,4)*n_H-cell[gridp].rate[109]*Ith(y,12)*n_H-cell[gridp].rate[111]*Ith(y,13)*n_H-cell[gridp].rate[112]*Ith(y,14)*n_H-cell[gridp].rate[113]*Ith(y,22)*n_H-cell[gridp].rate[116]*Ith(y,15)*n_H-cell[gridp].rate[157]*Ith(y,18)*n_H-cell[gridp].rate[170]*Ith(y,3)*n_H-cell[gridp].rate[178]*Ith(y,1)*n_H-cell[gridp].rate[182]*Ith(y,10)*n_H-cell[gridp].rate[187]*Ith(y,7)*n_H-cell[gridp].rate[188]*Ith(y,8)*n_H-cell[gridp].rate[189]*Ith(y,12)*n_H-cell[gridp].rate[191]*Ith(y,14)*n_H-cell[gridp].rate[192]*Ith(y,15)*n_H-cell[gridp].rate[257]*Ith(y,30)*n_H-cell[gridp].rate[269]-cell[gridp].rate[270]-cell[gridp].rate[301]-cell[gridp].rate[316]*Ith(y,31)*n_H-cell[gridp].rate[322]*Ith(y,30)*n_H-cell[gridp].rate[326]*Ith(y,29)*n_H;
  form = +cell[gridp].rate[1]*Ith(y,16)*Ith(y,31)*n_H+cell[gridp].rate[8]*Ith(y,24)*Ith(y,30)*n_H+2*cell[gridp].rate[15]*Ith(y,16)*Ith(y,24)*n_H+cell[gridp].rate[16]*Ith(y,24)*Ith(y,28)*n_H+cell[gridp].rate[24]*Ith(y,16)*Ith(y,16)*n_H+cell[gridp].rate[25]*Ith(y,16)*Ith(y,29)*n_H+cell[gridp].rate[30]*Ith(y,16)*Ith(y,28)*n_H+cell[gridp].rate[122]*Ith(y,14)*Ith(y,16)*n_H+cell[gridp].rate[190]*Ith(y,2)*Ith(y,26)*n_H+cell[gridp].rate[219]*Ith(y,23)*x_e*n_H+cell[gridp].rate[223]*Ith(y,19)*x_e*n_H+cell[gridp].rate[224]*Ith(y,19)*x_e*n_H+cell[gridp].rate[251]*Ith(y,24)*Ith(y,31)*n_H+cell[gridp].rate[273]*Ith(y,16)+cell[gridp].rate[278]*Ith(y,21)+cell[gridp].rate[282]*Ith(y,11)+cell[gridp].rate[304]*Ith(y,16)+cell[gridp].rate[307]*Ith(y,21);
  Ith(ydot,20) = form+Ith(y,20)*loss;

  loss = -cell[gridp].rate[2]*Ith(y,31)*n_H-cell[gridp].rate[11]*Ith(y,30)*n_H-2*cell[gridp].rate[32]*Ith(y,21)*n_H-cell[gridp].rate[33]*Ith(y,28)*n_H-cell[gridp].rate[34]*Ith(y,28)*n_H-cell[gridp].rate[35]*Ith(y,17)*n_H-cell[gridp].rate[70]*Ith(y,0)*n_H-cell[gridp].rate[80]*Ith(y,1)*n_H-cell[gridp].rate[159]*Ith(y,18)*n_H-cell[gridp].rate[275]-cell[gridp].rate[276]-cell[gridp].rate[278]-cell[gridp].rate[305]-cell[gridp].rate[306]-cell[gridp].rate[307];
  form = +cell[gridp].rate[3]*Ith(y,11)*Ith(y,31)*n_H+cell[gridp].rate[10]*Ith(y,16)*Ith(y,30)*n_H+cell[gridp].rate[22]*Ith(y,11)*Ith(y,20)*n_H+cell[gridp].rate[24]*Ith(y,16)*Ith(y,16)*n_H+2*cell[gridp].rate[28]*Ith(y,11)*Ith(y,16)*n_H+cell[gridp].rate[29]*Ith(y,16)*Ith(y,28)*n_H+cell[gridp].rate[36]*Ith(y,11)*Ith(y,29)*n_H+cell[gridp].rate[39]*Ith(y,11)*Ith(y,28)*n_H+cell[gridp].rate[83]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[132]*Ith(y,6)*Ith(y,11)*n_H+cell[gridp].rate[135]*Ith(y,6)*Ith(y,17)*n_H+cell[gridp].rate[136]*Ith(y,11)*Ith(y,12)*n_H+cell[gridp].rate[137]*Ith(y,6)*Ith(y,27)*n_H+cell[gridp].rate[138]*Ith(y,11)*Ith(y,14)*n_H+cell[gridp].rate[198]*Ith(y,2)*Ith(y,19)*n_H+cell[gridp].rate[226]*Ith(y,6)*x_e*n_H+cell[gridp].rate[229]*Ith(y,4)*x_e*n_H+cell[gridp].rate[246]*Ith(y,19)*x_e*n_H+cell[gridp].rate[257]*Ith(y,20)*Ith(y,30)*n_H+cell[gridp].rate[280]*Ith(y,11);
  Ith(ydot,21) = form+Ith(y,21)*loss;

  loss = -cell[gridp].rate[99]*Ith(y,24)*n_H-cell[gridp].rate[113]*Ith(y,20)*n_H-cell[gridp].rate[123]*Ith(y,16)*n_H-cell[gridp].rate[145]*Ith(y,28)*n_H-cell[gridp].rate[152]*Ith(y,17)*n_H-cell[gridp].rate[239]*x_e*n_H;
  form = +cell[gridp].rate[65]*Ith(y,3)*Ith(y,27)*n_H+cell[gridp].rate[66]*Ith(y,14)*Ith(y,30)*n_H+cell[gridp].rate[76]*Ith(y,0)*Ith(y,27)*n_H+cell[gridp].rate[97]*Ith(y,10)*Ith(y,17)*n_H+cell[gridp].rate[98]*Ith(y,13)*Ith(y,24)*n_H+cell[gridp].rate[110]*Ith(y,17)*Ith(y,26)*n_H+cell[gridp].rate[112]*Ith(y,14)*Ith(y,20)*n_H+cell[gridp].rate[115]*Ith(y,5)*Ith(y,26)*n_H+cell[gridp].rate[116]*Ith(y,15)*Ith(y,20)*n_H+cell[gridp].rate[117]*Ith(y,23)*Ith(y,29)*n_H+cell[gridp].rate[122]*Ith(y,14)*Ith(y,16)*n_H+cell[gridp].rate[124]*Ith(y,5)*Ith(y,23)*n_H+cell[gridp].rate[125]*Ith(y,19)*Ith(y,29)*n_H+cell[gridp].rate[137]*Ith(y,6)*Ith(y,27)*n_H+cell[gridp].rate[138]*Ith(y,11)*Ith(y,14)*n_H+cell[gridp].rate[143]*Ith(y,8)*Ith(y,27)*n_H+cell[gridp].rate[144]*Ith(y,14)*Ith(y,28)*n_H+cell[gridp].rate[148]*Ith(y,4)*Ith(y,27)*n_H+cell[gridp].rate[150]*Ith(y,12)*Ith(y,27)*n_H+cell[gridp].rate[151]*Ith(y,14)*Ith(y,17)*n_H+cell[gridp].rate[326]*Ith(y,20)*Ith(y,29)*n_H;
  Ith(ydot,22) = form+Ith(y,22)*loss;

  loss = -cell[gridp].rate[43]*Ith(y,31)*n_H-cell[gridp].rate[55]*Ith(y,30)*n_H-cell[gridp].rate[117]*Ith(y,29)*n_H-cell[gridp].rate[124]*Ith(y,5)*n_H-cell[gridp].rate[219]*x_e*n_H-cell[gridp].rate[220]*x_e*n_H-cell[gridp].rate[221]*x_e*n_H-cell[gridp].rate[274];
  form = +cell[gridp].rate[44]*Ith(y,19)*Ith(y,31)*n_H+cell[gridp].rate[52]*Ith(y,3)*Ith(y,20)*n_H+cell[gridp].rate[53]*Ith(y,26)*Ith(y,30)*n_H+cell[gridp].rate[68]*Ith(y,0)*Ith(y,20)*n_H+cell[gridp].rate[82]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[105]*Ith(y,8)*Ith(y,20)*n_H+cell[gridp].rate[107]*Ith(y,4)*Ith(y,20)*n_H+cell[gridp].rate[109]*Ith(y,12)*Ith(y,20)*n_H+cell[gridp].rate[111]*Ith(y,13)*Ith(y,20)*n_H+cell[gridp].rate[113]*Ith(y,20)*Ith(y,22)*n_H+cell[gridp].rate[158]*Ith(y,16)*Ith(y,18)*n_H+cell[gridp].rate[171]*Ith(y,3)*Ith(y,16)*n_H+cell[gridp].rate[183]*Ith(y,10)*Ith(y,16)*n_H+cell[gridp].rate[193]*Ith(y,7)*Ith(y,16)*n_H+cell[gridp].rate[194]*Ith(y,8)*Ith(y,16)*n_H+cell[gridp].rate[195]*Ith(y,12)*Ith(y,16)*n_H+cell[gridp].rate[196]*Ith(y,14)*Ith(y,16)*n_H+cell[gridp].rate[197]*Ith(y,15)*Ith(y,16)*n_H+cell[gridp].rate[256]*Ith(y,10)*Ith(y,30)*n_H+cell[gridp].rate[272]*Ith(y,16)+cell[gridp].rate[277]*Ith(y,19)+cell[gridp].rate[303]*Ith(y,16);
  Ith(ydot,23) = form+Ith(y,23)*loss;

  loss = -cell[gridp].rate[8]*Ith(y,30)*n_H-cell[gridp].rate[15]*Ith(y,16)*n_H-cell[gridp].rate[16]*Ith(y,28)*n_H-cell[gridp].rate[17]*Ith(y,28)*n_H-cell[gridp].rate[18]*Ith(y,5)*n_H-cell[gridp].rate[50]*Ith(y,3)*n_H-cell[gridp].rate[67]*Ith(y,0)*n_H-cell[gridp].rate[92]*Ith(y,8)*n_H-cell[gridp].rate[95]*Ith(y,4)*n_H-cell[gridp].rate[96]*Ith(y,12)*n_H-cell[gridp].rate[98]*Ith(y,13)*n_H-cell[gridp].rate[99]*Ith(y,22)*n_H-cell[gridp].rate[102]*Ith(y,15)*n_H-cell[gridp].rate[177]*Ith(y,1)*n_H-cell[gridp].rate[185]*Ith(y,14)*n_H-cell[gridp].rate[186]*Ith(y,15)*n_H-cell[gridp].rate[251]*Ith(y,31)*n_H-cell[gridp].rate[255]*Ith(y,30)*n_H-cell[gridp].rate[259]*Ith(y,7)*n_H-cell[gridp].rate[260]*Ith(y,29)*n_H-cell[gridp].rate[261]*Ith(y,29)*n_H-cell[gridp].rate[268]-cell[gridp].rate[297]-cell[gridp].rate[300];
  form = +cell[gridp].rate[0]*Ith(y,20)*Ith(y,31)*n_H+cell[gridp].rate[6]*Ith(y,27)*Ith(y,31)*n_H+cell[gridp].rate[19]*Ith(y,20)*Ith(y,29)*n_H+cell[gridp].rate[90]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[108]*Ith(y,17)*Ith(y,26)*n_H+cell[gridp].rate[112]*Ith(y,14)*Ith(y,20)*n_H+cell[gridp].rate[182]*Ith(y,10)*Ith(y,20)*n_H+cell[gridp].rate[183]*Ith(y,10)*Ith(y,16)*n_H+cell[gridp].rate[184]*Ith(y,2)*Ith(y,10)*n_H+cell[gridp].rate[218]*Ith(y,26)*x_e*n_H+cell[gridp].rate[220]*Ith(y,23)*x_e*n_H+cell[gridp].rate[221]*Ith(y,23)*x_e*n_H+cell[gridp].rate[225]*Ith(y,19)*x_e*n_H+cell[gridp].rate[238]*Ith(y,14)*x_e*n_H+cell[gridp].rate[243]*Ith(y,10)*x_e*n_H+cell[gridp].rate[244]*Ith(y,10)*x_e*n_H+cell[gridp].rate[245]*Ith(y,10)*x_e*n_H+cell[gridp].rate[270]*Ith(y,20)+cell[gridp].rate[271]*Ith(y,26)+cell[gridp].rate[289]*Ith(y,27)+cell[gridp].rate[301]*Ith(y,20)+cell[gridp].rate[312]*Ith(y,27)+cell[gridp].rate[316]*Ith(y,20)*Ith(y,31)*n_H+cell[gridp].rate[322]*Ith(y,20)*Ith(y,30)*n_H;
  Ith(ydot,24) = form+Ith(y,24)*loss;

  loss = -cell[gridp].rate[296];
  form = +cell[gridp].rate[49]*Ith(y,1)*Ith(y,30)*n_H+cell[gridp].rate[77]*Ith(y,1)*Ith(y,20)*n_H+cell[gridp].rate[78]*Ith(y,1)*Ith(y,16)*n_H+cell[gridp].rate[79]*Ith(y,1)*Ith(y,16)*n_H+cell[gridp].rate[80]*Ith(y,1)*Ith(y,21)*n_H+cell[gridp].rate[81]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[82]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[83]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[84]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[85]*Ith(y,1)*Ith(y,28)*n_H+cell[gridp].rate[86]*Ith(y,1)*Ith(y,17)*n_H+cell[gridp].rate[87]*Ith(y,1)*Ith(y,17)*n_H+cell[gridp].rate[88]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[89]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[90]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[91]*Ith(y,1)*Ith(y,5)*n_H+cell[gridp].rate[155]*Ith(y,1)*Ith(y,31)*n_H+cell[gridp].rate[156]*Ith(y,1)*Ith(y,31)*n_H+cell[gridp].rate[169]*Ith(y,1)*Ith(y,30)*n_H+cell[gridp].rate[177]*Ith(y,1)*Ith(y,24)*n_H+cell[gridp].rate[178]*Ith(y,1)*Ith(y,20)*n_H+cell[gridp].rate[179]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[180]*Ith(y,1)*Ith(y,17)*n_H+cell[gridp].rate[181]*Ith(y,1)*Ith(y,5)*n_H+cell[gridp].rate[242]*Ith(y,1)*x_e*n_H;
  Ith(ydot,25) = form+Ith(y,25)*loss;

  loss = -cell[gridp].rate[41]*Ith(y,31)*n_H-cell[gridp].rate[53]*Ith(y,30)*n_H-cell[gridp].rate[103]*Ith(y,29)*n_H-cell[gridp].rate[106]*Ith(y,28)*n_H-cell[gridp].rate[108]*Ith(y,17)*n_H-cell[gridp].rate[110]*Ith(y,17)*n_H-cell[gridp].rate[114]*Ith(y,5)*n_H-cell[gridp].rate[115]*Ith(y,5)*n_H-cell[gridp].rate[190]*Ith(y,2)*n_H-cell[gridp].rate[218]*x_e*n_H-cell[gridp].rate[271]-cell[gridp].rate[302];
  form = +cell[gridp].rate[42]*Ith(y,16)*Ith(y,18)*n_H+cell[gridp].rate[43]*Ith(y,23)*Ith(y,31)*n_H+cell[gridp].rate[50]*Ith(y,3)*Ith(y,24)*n_H+cell[gridp].rate[51]*Ith(y,10)*Ith(y,30)*n_H+cell[gridp].rate[67]*Ith(y,0)*Ith(y,24)*n_H+cell[gridp].rate[79]*Ith(y,1)*Ith(y,16)*n_H+cell[gridp].rate[80]*Ith(y,1)*Ith(y,21)*n_H+cell[gridp].rate[81]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[92]*Ith(y,8)*Ith(y,24)*n_H+cell[gridp].rate[95]*Ith(y,4)*Ith(y,24)*n_H+cell[gridp].rate[96]*Ith(y,12)*Ith(y,24)*n_H+cell[gridp].rate[99]*Ith(y,22)*Ith(y,24)*n_H+cell[gridp].rate[157]*Ith(y,18)*Ith(y,20)*n_H+cell[gridp].rate[170]*Ith(y,3)*Ith(y,20)*n_H+cell[gridp].rate[178]*Ith(y,1)*Ith(y,20)*n_H+cell[gridp].rate[182]*Ith(y,10)*Ith(y,20)*n_H+cell[gridp].rate[187]*Ith(y,7)*Ith(y,20)*n_H+cell[gridp].rate[188]*Ith(y,8)*Ith(y,20)*n_H+cell[gridp].rate[189]*Ith(y,12)*Ith(y,20)*n_H+cell[gridp].rate[191]*Ith(y,14)*Ith(y,20)*n_H+cell[gridp].rate[192]*Ith(y,15)*Ith(y,20)*n_H+cell[gridp].rate[252]*Ith(y,10)*Ith(y,31)*n_H+cell[gridp].rate[269]*Ith(y,20)+cell[gridp].rate[274]*Ith(y,23)+cell[gridp].rate[279]*Ith(y,19);
  Ith(ydot,26) = form+Ith(y,26)*loss;

  loss = -cell[gridp].rate[6]*Ith(y,31)*n_H-cell[gridp].rate[65]*Ith(y,3)*n_H-cell[gridp].rate[76]*Ith(y,0)*n_H-cell[gridp].rate[88]*Ith(y,1)*n_H-cell[gridp].rate[89]*Ith(y,1)*n_H-cell[gridp].rate[90]*Ith(y,1)*n_H-cell[gridp].rate[137]*Ith(y,6)*n_H-cell[gridp].rate[143]*Ith(y,8)*n_H-cell[gridp].rate[148]*Ith(y,4)*n_H-cell[gridp].rate[150]*Ith(y,12)*n_H-cell[gridp].rate[175]*Ith(y,3)*n_H-cell[gridp].rate[203]*Ith(y,7)*n_H-cell[gridp].rate[289]-cell[gridp].rate[299]-cell[gridp].rate[312];
  form = +cell[gridp].rate[17]*Ith(y,24)*Ith(y,28)*n_H+cell[gridp].rate[18]*Ith(y,5)*Ith(y,24)*n_H+cell[gridp].rate[20]*Ith(y,20)*Ith(y,29)*n_H+cell[gridp].rate[21]*Ith(y,20)*Ith(y,29)*n_H+cell[gridp].rate[23]*Ith(y,5)*Ith(y,20)*n_H+cell[gridp].rate[26]*Ith(y,16)*Ith(y,29)*n_H+cell[gridp].rate[27]*Ith(y,16)*Ith(y,29)*n_H+cell[gridp].rate[31]*Ith(y,5)*Ith(y,16)*n_H+cell[gridp].rate[94]*Ith(y,10)*Ith(y,28)*n_H+cell[gridp].rate[99]*Ith(y,22)*Ith(y,24)*n_H+cell[gridp].rate[101]*Ith(y,5)*Ith(y,10)*n_H+cell[gridp].rate[113]*Ith(y,20)*Ith(y,22)*n_H+cell[gridp].rate[123]*Ith(y,16)*Ith(y,22)*n_H+cell[gridp].rate[145]*Ith(y,22)*Ith(y,28)*n_H+cell[gridp].rate[152]*Ith(y,17)*Ith(y,22)*n_H+cell[gridp].rate[167]*Ith(y,14)*Ith(y,31)*n_H+cell[gridp].rate[185]*Ith(y,14)*Ith(y,24)*n_H+cell[gridp].rate[191]*Ith(y,14)*Ith(y,20)*n_H+cell[gridp].rate[196]*Ith(y,14)*Ith(y,16)*n_H+cell[gridp].rate[202]*Ith(y,14)*Ith(y,29)*n_H+cell[gridp].rate[205]*Ith(y,11)*Ith(y,14)*n_H+cell[gridp].rate[208]*Ith(y,14)*Ith(y,28)*n_H+cell[gridp].rate[211]*Ith(y,14)*Ith(y,17)*n_H+cell[gridp].rate[214]*Ith(y,5)*Ith(y,14)*n_H+cell[gridp].rate[239]*Ith(y,22)*x_e*n_H+cell[gridp].rate[260]*Ith(y,24)*Ith(y,29)*n_H+cell[gridp].rate[261]*Ith(y,24)*Ith(y,29)*n_H;
  Ith(ydot,27) = form+Ith(y,27)*loss;

  loss = -cell[gridp].rate[4]*Ith(y,31)*n_H-cell[gridp].rate[13]*Ith(y,30)*n_H-cell[gridp].rate[16]*Ith(y,24)*n_H-cell[gridp].rate[17]*Ith(y,24)*n_H-cell[gridp].rate[29]*Ith(y,16)*n_H-cell[gridp].rate[30]*Ith(y,16)*n_H-cell[gridp].rate[33]*Ith(y,21)*n_H-cell[gridp].rate[34]*Ith(y,21)*n_H-cell[gridp].rate[37]*Ith(y,29)*n_H-cell[gridp].rate[39]*Ith(y,11)*n_H-2*cell[gridp].rate[40]*Ith(y,28)*n_H-cell[gridp].rate[61]*Ith(y,3)*n_H-cell[gridp].rate[73]*Ith(y,0)*n_H-cell[gridp].rate[85]*Ith(y,1)*n_H-cell[gridp].rate[93]*Ith(y,10)*n_H-cell[gridp].rate[94]*Ith(y,10)*n_H-cell[gridp].rate[106]*Ith(y,26)*n_H-cell[gridp].rate[128]*Ith(y,7)*n_H-cell[gridp].rate[139]*Ith(y,8)*n_H-cell[gridp].rate[140]*Ith(y,4)*n_H-cell[gridp].rate[142]*Ith(y,12)*n_H-cell[gridp].rate[144]*Ith(y,14)*n_H-cell[gridp].rate[145]*Ith(y,22)*n_H-cell[gridp].rate[164]*Ith(y,18)*n_H-cell[gridp].rate[173]*Ith(y,3)*n_H-cell[gridp].rate[200]*Ith(y,7)*n_H-cell[gridp].rate[208]*Ith(y,14)*n_H-cell[gridp].rate[254]*Ith(y,31)*n_H-cell[gridp].rate[283]-cell[gridp].rate[284]-cell[gridp].rate[309]-cell[gridp].rate[317]*Ith(y,31)*n_H-cell[gridp].rate[323]*Ith(y,30)*n_H;
  form = +cell[gridp].rate[5]*Ith(y,17)*Ith(y,31)*n_H+cell[gridp].rate[6]*Ith(y,27)*Ith(y,31)*n_H+cell[gridp].rate[7]*Ith(y,5)*Ith(y,31)*n_H+cell[gridp].rate[12]*Ith(y,29)*Ith(y,30)*n_H+2*cell[gridp].rate[14]*Ith(y,5)*Ith(y,30)*n_H+cell[gridp].rate[19]*Ith(y,20)*Ith(y,29)*n_H+cell[gridp].rate[23]*Ith(y,5)*Ith(y,20)*n_H+cell[gridp].rate[25]*Ith(y,16)*Ith(y,29)*n_H+cell[gridp].rate[35]*Ith(y,17)*Ith(y,21)*n_H+cell[gridp].rate[36]*Ith(y,11)*Ith(y,29)*n_H+2*cell[gridp].rate[38]*Ith(y,17)*Ith(y,29)*n_H+cell[gridp].rate[86]*Ith(y,1)*Ith(y,17)*n_H+cell[gridp].rate[96]*Ith(y,12)*Ith(y,24)*n_H+cell[gridp].rate[109]*Ith(y,12)*Ith(y,20)*n_H+cell[gridp].rate[114]*Ith(y,5)*Ith(y,26)*n_H+cell[gridp].rate[120]*Ith(y,12)*Ith(y,16)*n_H+cell[gridp].rate[124]*Ith(y,5)*Ith(y,23)*n_H+cell[gridp].rate[126]*Ith(y,7)*Ith(y,11)*n_H+cell[gridp].rate[127]*Ith(y,6)*Ith(y,29)*n_H+cell[gridp].rate[149]*Ith(y,12)*Ith(y,17)*n_H+cell[gridp].rate[150]*Ith(y,12)*Ith(y,27)*n_H+cell[gridp].rate[151]*Ith(y,14)*Ith(y,17)*n_H+cell[gridp].rate[188]*Ith(y,8)*Ith(y,20)*n_H+cell[gridp].rate[194]*Ith(y,8)*Ith(y,16)*n_H+cell[gridp].rate[207]*Ith(y,8)*Ith(y,17)*n_H+cell[gridp].rate[209]*Ith(y,5)*Ith(y,8)*n_H+cell[gridp].rate[233]*Ith(y,12)*x_e*n_H+cell[gridp].rate[235]*Ith(y,13)*x_e*n_H+cell[gridp].rate[236]*Ith(y,13)*x_e*n_H+cell[gridp].rate[253]*Ith(y,29)*Ith(y,31)*n_H+cell[gridp].rate[286]*Ith(y,17)+cell[gridp].rate[310]*Ith(y,17)+cell[gridp].rate[318]*Ith(y,17)*Ith(y,31)*n_H+cell[gridp].rate[324]*Ith(y,17)*Ith(y,30)*n_H;
  Ith(ydot,28) = form+Ith(y,28)*loss;

  loss = -cell[gridp].rate[12]*Ith(y,30)*n_H-cell[gridp].rate[19]*Ith(y,20)*n_H-cell[gridp].rate[20]*Ith(y,20)*n_H-cell[gridp].rate[21]*Ith(y,20)*n_H-cell[gridp].rate[25]*Ith(y,16)*n_H-cell[gridp].rate[26]*Ith(y,16)*n_H-cell[gridp].rate[27]*Ith(y,16)*n_H-cell[gridp].rate[36]*Ith(y,11)*n_H-cell[gridp].rate[37]*Ith(y,28)*n_H-cell[gridp].rate[38]*Ith(y,17)*n_H-cell[gridp].rate[56]*Ith(y,3)*n_H-cell[gridp].rate[71]*Ith(y,0)*n_H-cell[gridp].rate[103]*Ith(y,26)*n_H-cell[gridp].rate[117]*Ith(y,23)*n_H-cell[gridp].rate[125]*Ith(y,19)*n_H-cell[gridp].rate[127]*Ith(y,6)*n_H-cell[gridp].rate[129]*Ith(y,8)*n_H-cell[gridp].rate[130]*Ith(y,4)*n_H-cell[gridp].rate[131]*Ith(y,12)*n_H-cell[gridp].rate[161]*Ith(y,18)*n_H-cell[gridp].rate[162]*Ith(y,18)*n_H-cell[gridp].rate[202]*Ith(y,14)*n_H-cell[gridp].rate[253]*Ith(y,31)*n_H-cell[gridp].rate[260]*Ith(y,24)*n_H-cell[gridp].rate[261]*Ith(y,24)*n_H-cell[gridp].rate[262]*Ith(y,10)*n_H-cell[gridp].rate[263]*Ith(y,10)*n_H-2*cell[gridp].rate[264]*Ith(y,29)*n_H-cell[gridp].rate[298]-cell[gridp].rate[326]*Ith(y,20)*n_H;
  form = +cell[gridp].rate[4]*Ith(y,28)*Ith(y,31)*n_H+cell[gridp].rate[7]*Ith(y,5)*Ith(y,31)*n_H+cell[gridp].rate[16]*Ith(y,24)*Ith(y,28)*n_H+cell[gridp].rate[18]*Ith(y,5)*Ith(y,24)*n_H+cell[gridp].rate[29]*Ith(y,16)*Ith(y,28)*n_H+cell[gridp].rate[33]*Ith(y,21)*Ith(y,28)*n_H+cell[gridp].rate[40]*Ith(y,28)*Ith(y,28)*n_H+cell[gridp].rate[88]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[89]*Ith(y,1)*Ith(y,27)*n_H+cell[gridp].rate[91]*Ith(y,1)*Ith(y,5)*n_H+cell[gridp].rate[92]*Ith(y,8)*Ith(y,24)*n_H+cell[gridp].rate[100]*Ith(y,5)*Ith(y,10)*n_H+cell[gridp].rate[102]*Ith(y,15)*Ith(y,24)*n_H+cell[gridp].rate[105]*Ith(y,8)*Ith(y,20)*n_H+cell[gridp].rate[115]*Ith(y,5)*Ith(y,26)*n_H+cell[gridp].rate[116]*Ith(y,15)*Ith(y,20)*n_H+cell[gridp].rate[118]*Ith(y,8)*Ith(y,16)*n_H+cell[gridp].rate[133]*Ith(y,8)*Ith(y,11)*n_H+cell[gridp].rate[139]*Ith(y,8)*Ith(y,28)*n_H+cell[gridp].rate[141]*Ith(y,8)*Ith(y,17)*n_H+cell[gridp].rate[142]*Ith(y,12)*Ith(y,28)*n_H+cell[gridp].rate[143]*Ith(y,8)*Ith(y,27)*n_H+cell[gridp].rate[144]*Ith(y,14)*Ith(y,28)*n_H+cell[gridp].rate[160]*Ith(y,7)*Ith(y,31)*n_H+cell[gridp].rate[187]*Ith(y,7)*Ith(y,20)*n_H+cell[gridp].rate[193]*Ith(y,7)*Ith(y,16)*n_H+cell[gridp].rate[199]*Ith(y,7)*Ith(y,11)*n_H+cell[gridp].rate[200]*Ith(y,7)*Ith(y,28)*n_H+cell[gridp].rate[201]*Ith(y,7)*Ith(y,17)*n_H+cell[gridp].rate[203]*Ith(y,7)*Ith(y,27)*n_H+cell[gridp].rate[204]*Ith(y,5)*Ith(y,7)*n_H+cell[gridp].rate[228]*Ith(y,8)*x_e*n_H+cell[gridp].rate[231]*Ith(y,12)*x_e*n_H+cell[gridp].rate[232]*Ith(y,12)*x_e*n_H+cell[gridp].rate[234]*Ith(y,13)*x_e*n_H+cell[gridp].rate[238]*Ith(y,14)*x_e*n_H+2*cell[gridp].rate[240]*Ith(y,15)*x_e*n_H+cell[gridp].rate[247]*Ith(y,7)*x_e*n_H+cell[gridp].rate[284]*Ith(y,28)+cell[gridp].rate[285]*Ith(y,8)+cell[gridp].rate[289]*Ith(y,27)+2*cell[gridp].rate[290]*Ith(y,5)+cell[gridp].rate[309]*Ith(y,28)+cell[gridp].rate[312]*Ith(y,27)+2*cell[gridp].rate[313]*Ith(y,5)+cell[gridp].rate[317]*Ith(y,28)*Ith(y,31)*n_H+2*cell[gridp].rate[319]*Ith(y,5)*Ith(y,31)*n_H+cell[gridp].rate[323]*Ith(y,28)*Ith(y,30)*n_H+2*cell[gridp].rate[325]*Ith(y,5)*Ith(y,30)*n_H;
  Ith(ydot,29) = form+Ith(y,29)*loss;

  loss = -cell[gridp].rate[8]*Ith(y,24)*n_H-cell[gridp].rate[9]*Ith(y,20)*n_H-cell[gridp].rate[10]*Ith(y,16)*n_H-cell[gridp].rate[11]*Ith(y,21)*n_H-cell[gridp].rate[12]*Ith(y,29)*n_H-cell[gridp].rate[13]*Ith(y,28)*n_H-cell[gridp].rate[14]*Ith(y,5)*n_H-cell[gridp].rate[48]*Ith(y,3)*n_H-cell[gridp].rate[49]*Ith(y,1)*n_H-cell[gridp].rate[51]*Ith(y,10)*n_H-cell[gridp].rate[53]*Ith(y,26)*n_H-cell[gridp].rate[55]*Ith(y,23)*n_H-cell[gridp].rate[57]*Ith(y,7)*n_H-cell[gridp].rate[59]*Ith(y,6)*n_H-cell[gridp].rate[62]*Ith(y,8)*n_H-cell[gridp].rate[64]*Ith(y,12)*n_H-cell[gridp].rate[66]*Ith(y,14)*n_H-cell[gridp].rate[153]*Ith(y,18)*n_H-cell[gridp].rate[169]*Ith(y,1)*n_H-cell[gridp].rate[255]*Ith(y,24)*n_H-cell[gridp].rate[256]*Ith(y,10)*n_H-cell[gridp].rate[257]*Ith(y,20)*n_H-cell[gridp].rate[258]*Ith(y,19)*n_H-cell[gridp].rate[293]-cell[gridp].rate[294]-cell[gridp].rate[295]-cell[gridp].rate[315]*Ith(y,31)*n_H-cell[gridp].rate[320]*x_e*n_H-2*cell[gridp].rate[321]*Ith(y,30)*n_H-cell[gridp].rate[322]*Ith(y,20)*n_H-cell[gridp].rate[323]*Ith(y,28)*n_H-cell[gridp].rate[324]*Ith(y,17)*n_H-cell[gridp].rate[325]*Ith(y,5)*n_H-cell[gridp].rate[328];
  form = +cell[gridp].rate[0]*Ith(y,20)*Ith(y,31)*n_H+cell[gridp].rate[1]*Ith(y,16)*Ith(y,31)*n_H+cell[gridp].rate[2]*Ith(y,21)*Ith(y,31)*n_H+cell[gridp].rate[3]*Ith(y,11)*Ith(y,31)*n_H+cell[gridp].rate[4]*Ith(y,28)*Ith(y,31)*n_H+cell[gridp].rate[5]*Ith(y,17)*Ith(y,31)*n_H+cell[gridp].rate[27]*Ith(y,16)*Ith(y,29)*n_H+cell[gridp].rate[41]*Ith(y,26)*Ith(y,31)*n_H+cell[gridp].rate[42]*Ith(y,16)*Ith(y,18)*n_H+cell[gridp].rate[43]*Ith(y,23)*Ith(y,31)*n_H+cell[gridp].rate[44]*Ith(y,19)*Ith(y,31)*n_H+cell[gridp].rate[45]*Ith(y,11)*Ith(y,18)*n_H+cell[gridp].rate[46]*Ith(y,6)*Ith(y,31)*n_H+cell[gridp].rate[47]*Ith(y,4)*Ith(y,31)*n_H+cell[gridp].rate[60]*Ith(y,3)*Ith(y,11)*n_H+cell[gridp].rate[67]*Ith(y,0)*Ith(y,24)*n_H+cell[gridp].rate[68]*Ith(y,0)*Ith(y,20)*n_H+cell[gridp].rate[69]*Ith(y,0)*Ith(y,16)*n_H+cell[gridp].rate[70]*Ith(y,0)*Ith(y,21)*n_H+cell[gridp].rate[71]*Ith(y,0)*Ith(y,29)*n_H+cell[gridp].rate[72]*Ith(y,0)*Ith(y,11)*n_H+cell[gridp].rate[73]*Ith(y,0)*Ith(y,28)*n_H+cell[gridp].rate[74]*Ith(y,0)*Ith(y,17)*n_H+cell[gridp].rate[75]*Ith(y,0)*Ith(y,2)*n_H+cell[gridp].rate[76]*Ith(y,0)*Ith(y,27)*n_H+cell[gridp].rate[78]*Ith(y,1)*Ith(y,16)*n_H+cell[gridp].rate[80]*Ith(y,1)*Ith(y,21)*n_H+cell[gridp].rate[81]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[82]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[98]*Ith(y,13)*Ith(y,24)*n_H+cell[gridp].rate[106]*Ith(y,26)*Ith(y,28)*n_H+cell[gridp].rate[110]*Ith(y,17)*Ith(y,26)*n_H+cell[gridp].rate[125]*Ith(y,19)*Ith(y,29)*n_H+cell[gridp].rate[131]*Ith(y,12)*Ith(y,29)*n_H+cell[gridp].rate[154]*Ith(y,3)*Ith(y,31)*n_H+cell[gridp].rate[170]*Ith(y,3)*Ith(y,20)*n_H+cell[gridp].rate[171]*Ith(y,3)*Ith(y,16)*n_H+cell[gridp].rate[172]*Ith(y,3)*Ith(y,11)*n_H+cell[gridp].rate[173]*Ith(y,3)*Ith(y,28)*n_H+cell[gridp].rate[174]*Ith(y,3)*Ith(y,17)*n_H+cell[gridp].rate[175]*Ith(y,3)*Ith(y,27)*n_H+cell[gridp].rate[176]*Ith(y,3)*Ith(y,5)*n_H+cell[gridp].rate[217]*Ith(y,0)*x_e*n_H+cell[gridp].rate[221]*Ith(y,23)*x_e*n_H+cell[gridp].rate[223]*Ith(y,19)*x_e*n_H+cell[gridp].rate[225]*Ith(y,19)*x_e*n_H+cell[gridp].rate[229]*Ith(y,4)*x_e*n_H+cell[gridp].rate[232]*Ith(y,12)*x_e*n_H+cell[gridp].rate[234]*Ith(y,13)*x_e*n_H+cell[gridp].rate[236]*Ith(y,13)*x_e*n_H+cell[gridp].rate[267]*Ith(y,0)+cell[gridp].rate[278]*Ith(y,21)+cell[gridp].rate[279]*Ith(y,19)+cell[gridp].rate[281]*Ith(y,11)+cell[gridp].rate[282]*Ith(y,11)+cell[gridp].rate[307]*Ith(y,21)+cell[gridp].rate[308]*Ith(y,11)+cell[gridp].rate[321]*Ith(y,30)*Ith(y,30)*n_H+cell[gridp].rate[322]*Ith(y,20)*Ith(y,30)*n_H+cell[gridp].rate[323]*Ith(y,28)*Ith(y,30)*n_H+cell[gridp].rate[324]*Ith(y,17)*Ith(y,30)*n_H+cell[gridp].rate[325]*Ith(y,5)*Ith(y,30)*n_H+cell[gridp].rate[327]*Ith(y,31)*n_H;
  Ith(ydot,30) = form+Ith(y,30)*loss;

  loss = -cell[gridp].rate[0]*Ith(y,20)*n_H-cell[gridp].rate[1]*Ith(y,16)*n_H-cell[gridp].rate[2]*Ith(y,21)*n_H-cell[gridp].rate[3]*Ith(y,11)*n_H-cell[gridp].rate[4]*Ith(y,28)*n_H-cell[gridp].rate[5]*Ith(y,17)*n_H-cell[gridp].rate[6]*Ith(y,27)*n_H-cell[gridp].rate[7]*Ith(y,5)*n_H-cell[gridp].rate[41]*Ith(y,26)*n_H-cell[gridp].rate[43]*Ith(y,23)*n_H-cell[gridp].rate[44]*Ith(y,19)*n_H-cell[gridp].rate[46]*Ith(y,6)*n_H-cell[gridp].rate[47]*Ith(y,4)*n_H-cell[gridp].rate[154]*Ith(y,3)*n_H-cell[gridp].rate[155]*Ith(y,1)*n_H-cell[gridp].rate[156]*Ith(y,1)*n_H-cell[gridp].rate[160]*Ith(y,7)*n_H-cell[gridp].rate[167]*Ith(y,14)*n_H-cell[gridp].rate[249]*Ith(y,18)*n_H-cell[gridp].rate[250]*Ith(y,18)*n_H-cell[gridp].rate[251]*Ith(y,24)*n_H-cell[gridp].rate[252]*Ith(y,10)*n_H-cell[gridp].rate[253]*Ith(y,29)*n_H-cell[gridp].rate[254]*Ith(y,28)*n_H-cell[gridp].rate[292]-cell[gridp].rate[315]*Ith(y,30)*n_H-cell[gridp].rate[316]*Ith(y,20)*n_H-cell[gridp].rate[317]*Ith(y,28)*n_H-cell[gridp].rate[318]*Ith(y,17)*n_H-cell[gridp].rate[319]*Ith(y,5)*n_H-2*cell[gridp].rate[327]*n_H;
  form = +cell[gridp].rate[8]*Ith(y,24)*Ith(y,30)*n_H+cell[gridp].rate[9]*Ith(y,20)*Ith(y,30)*n_H+cell[gridp].rate[10]*Ith(y,16)*Ith(y,30)*n_H+cell[gridp].rate[11]*Ith(y,21)*Ith(y,30)*n_H+cell[gridp].rate[12]*Ith(y,29)*Ith(y,30)*n_H+cell[gridp].rate[13]*Ith(y,28)*Ith(y,30)*n_H+cell[gridp].rate[17]*Ith(y,24)*Ith(y,28)*n_H+cell[gridp].rate[20]*Ith(y,20)*Ith(y,29)*n_H+cell[gridp].rate[21]*Ith(y,20)*Ith(y,29)*n_H+2*cell[gridp].rate[26]*Ith(y,16)*Ith(y,29)*n_H+cell[gridp].rate[37]*Ith(y,28)*Ith(y,29)*n_H+cell[gridp].rate[48]*Ith(y,3)*Ith(y,30)*n_H+cell[gridp].rate[49]*Ith(y,1)*Ith(y,30)*n_H+cell[gridp].rate[50]*Ith(y,3)*Ith(y,24)*n_H+cell[gridp].rate[51]*Ith(y,10)*Ith(y,30)*n_H+cell[gridp].rate[52]*Ith(y,3)*Ith(y,20)*n_H+cell[gridp].rate[53]*Ith(y,26)*Ith(y,30)*n_H+cell[gridp].rate[54]*Ith(y,3)*Ith(y,16)*n_H+cell[gridp].rate[55]*Ith(y,23)*Ith(y,30)*n_H+cell[gridp].rate[56]*Ith(y,3)*Ith(y,29)*n_H+cell[gridp].rate[57]*Ith(y,7)*Ith(y,30)*n_H+cell[gridp].rate[58]*Ith(y,3)*Ith(y,11)*n_H+cell[gridp].rate[59]*Ith(y,6)*Ith(y,30)*n_H+cell[gridp].rate[60]*Ith(y,3)*Ith(y,11)*n_H+cell[gridp].rate[61]*Ith(y,3)*Ith(y,28)*n_H+cell[gridp].rate[62]*Ith(y,8)*Ith(y,30)*n_H+cell[gridp].rate[63]*Ith(y,3)*Ith(y,17)*n_H+cell[gridp].rate[64]*Ith(y,12)*Ith(y,30)*n_H+cell[gridp].rate[65]*Ith(y,3)*Ith(y,27)*n_H+cell[gridp].rate[66]*Ith(y,14)*Ith(y,30)*n_H+cell[gridp].rate[75]*Ith(y,0)*Ith(y,2)*n_H+cell[gridp].rate[77]*Ith(y,1)*Ith(y,20)*n_H+cell[gridp].rate[79]*Ith(y,1)*Ith(y,16)*n_H+cell[gridp].rate[81]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[84]*Ith(y,1)*Ith(y,11)*n_H+cell[gridp].rate[85]*Ith(y,1)*Ith(y,28)*n_H+cell[gridp].rate[87]*Ith(y,1)*Ith(y,17)*n_H+cell[gridp].rate[93]*Ith(y,10)*Ith(y,28)*n_H+cell[gridp].rate[97]*Ith(y,10)*Ith(y,17)*n_H+cell[gridp].rate[103]*Ith(y,26)*Ith(y,29)*n_H+cell[gridp].rate[104]*Ith(y,7)*Ith(y,20)*n_H+cell[gridp].rate[117]*Ith(y,23)*Ith(y,29)*n_H+cell[gridp].rate[128]*Ith(y,7)*Ith(y,28)*n_H+cell[gridp].rate[129]*Ith(y,8)*Ith(y,29)*n_H+cell[gridp].rate[147]*Ith(y,2)*Ith(y,4)*n_H+cell[gridp].rate[153]*Ith(y,18)*Ith(y,30)*n_H+cell[gridp].rate[157]*Ith(y,18)*Ith(y,20)*n_H+cell[gridp].rate[158]*Ith(y,16)*Ith(y,18)*n_H+cell[gridp].rate[159]*Ith(y,18)*Ith(y,21)*n_H+cell[gridp].rate[161]*Ith(y,18)*Ith(y,29)*n_H+cell[gridp].rate[162]*Ith(y,18)*Ith(y,29)*n_H+cell[gridp].rate[163]*Ith(y,11)*Ith(y,18)*n_H+cell[gridp].rate[164]*Ith(y,18)*Ith(y,28)*n_H+cell[gridp].rate[165]*Ith(y,17)*Ith(y,18)*n_H+cell[gridp].rate[166]*Ith(y,2)*Ith(y,18)*n_H+cell[gridp].rate[168]*Ith(y,5)*Ith(y,18)*n_H+2*cell[gridp].rate[215]*Ith(y,3)*x_e*n_H+3*cell[gridp].rate[216]*Ith(y,0)*x_e*n_H+cell[gridp].rate[217]*Ith(y,0)*x_e*n_H+cell[gridp].rate[218]*Ith(y,26)*x_e*n_H+cell[gridp].rate[219]*Ith(y,23)*x_e*n_H+2*cell[gridp].rate[220]*Ith(y,23)*x_e*n_H+cell[gridp].rate[222]*Ith(y,19)*x_e*n_H+2*cell[gridp].rate[224]*Ith(y,19)*x_e*n_H+cell[gridp].rate[225]*Ith(y,19)*x_e*n_H+cell[gridp].rate[226]*Ith(y,6)*x_e*n_H+2*cell[gridp].rate[227]*Ith(y,6)*x_e*n_H+cell[gridp].rate[228]*Ith(y,8)*x_e*n_H+cell[gridp].rate[230]*Ith(y,4)*x_e*n_H+2*cell[gridp].rate[231]*Ith(y,12)*x_e*n_H+cell[gridp].rate[233]*Ith(y,12)*x_e*n_H+cell[gridp].rate[234]*Ith(y,13)*x_e*n_H+2*cell[gridp].rate[235]*Ith(y,13)*x_e*n_H+cell[gridp].rate[237]*Ith(y,13)*x_e*n_H+cell[gridp].rate[239]*Ith(y,22)*x_e*n_H+cell[gridp].rate[241]*Ith(y,18)*x_e*n_H+cell[gridp].rate[265]*Ith(y,3)+cell[gridp].rate[266]*Ith(y,0)+cell[gridp].rate[270]*Ith(y,20)+cell[gridp].rate[273]*Ith(y,16)+cell[gridp].rate[274]*Ith(y,23)+cell[gridp].rate[276]*Ith(y,21)+cell[gridp].rate[277]*Ith(y,19)+cell[gridp].rate[280]*Ith(y,11)+cell[gridp].rate[282]*Ith(y,11)+cell[gridp].rate[284]*Ith(y,28)+cell[gridp].rate[286]*Ith(y,17)+cell[gridp].rate[293]*Ith(y,30)+2*cell[gridp].rate[294]*Ith(y,30)+cell[gridp].rate[301]*Ith(y,20)+cell[gridp].rate[302]*Ith(y,26)+cell[gridp].rate[304]*Ith(y,16)+cell[gridp].rate[306]*Ith(y,21)+cell[gridp].rate[309]*Ith(y,28)+cell[gridp].rate[310]*Ith(y,17)+3*cell[gridp].rate[315]*Ith(y,30)*Ith(y,31)*n_H+2*cell[gridp].rate[316]*Ith(y,20)*Ith(y,31)*n_H+2*cell[gridp].rate[317]*Ith(y,28)*Ith(y,31)*n_H+2*cell[gridp].rate[318]*Ith(y,17)*Ith(y,31)*n_H+cell[gridp].rate[319]*Ith(y,5)*Ith(y,31)*n_H+2*cell[gridp].rate[320]*Ith(y,30)*x_e*n_H+2*cell[gridp].rate[321]*Ith(y,30)*Ith(y,30)*n_H+cell[gridp].rate[322]*Ith(y,20)*Ith(y,30)*n_H+cell[gridp].rate[323]*Ith(y,28)*Ith(y,30)*n_H+cell[gridp].rate[324]*Ith(y,17)*Ith(y,30)*n_H+2*cell[gridp].rate[328]*Ith(y,30);
  Ith(ydot,31) = form+Ith(y,31)*loss;


  return(0);
}
 /*-----------------------------------------------------------------------------------------------*/

